!function(e){var t,o,_,n,a,d,r,u,i,l,m,s,p,c,h,x,v,f=e.event.special,g={},b=!1,y=-1,w="ue_bound",z=!1,S={bound_ns_map:{},px_radius:10,ignore_select:"textarea, select, input",max_tap_ms:200,min_held_ms:300},E=[],k=1,X=4;u=function(e){var t,o=0;for(t=this.length;t;0)this[--t]===e&&o++;return o},i=function(e){var t,o=0;for(t=this.length;t;0)this[--t]===e&&(this.splice(t,1),o++,t++);return o},l=function(e){return u.call(this,e)?!1:(this.push(e),!0)},m=function(t){if(t&&e.isArray(t)){if(t.remove_val)return t}else t=[];return t.remove_val=i,t.match_val=u,t.push_uniq=l,t},t=m(),o={setup:function(o,_){var n,a,d,r,u,i=this,l=e(i),s={};if(!e.data(this,w)){for(n={},e.extend(!0,n,S),e.data(i,w,n),u=m(_.slice(0)),u.length&&""!==u[0]||(u=["000"]),a=0;a<u.length;a++)d=u[a],d&&(s.hasOwnProperty(d)||(s[d]=!0,r=".__ue"+d,l.on("mousedown"+r,x),l.on("touchstart"+r,v)));t.push_uniq(i),b||(e(document).on("mousemove.__ue",x),e(document).on("touchmove.__ue",v),e(document).on("mouseup.__ue",x),e(document).on("touchend.__ue",v),e(document).on("touchcancel.__ue",v),b=!0)}},add:function(t){var o,_,n,a,d=this,r=e.data(d,w),u=t.namespace,i=t.type;if(r&&(o=r.bound_ns_map,o[i]||(o[i]={}),u))for(_=u.split("."),n=0;n<_.length;n++)a=_[n],o[i][a]=!0},remove:function(t){var o,_,n,a=this,d=e.data(a,w),r=d.bound_ns_map,u=t.type,i=t.namespace;if(r[u]){if(!i)return void delete r[u];for(o=i.split("."),_=0;_<o.length;_++)n=o[_],r[u][n]&&delete r[u][n];e.isEmptyObject(r[u])&&delete r[u]}},teardown:function(o){var _,n,a,d,r=this,u=e(r),i=e.data(r,w),l=i.bound_ns_map;if(e.isEmptyObject(l)){for(d=m(o),d.push_uniq("000"),_=0;_<d.length;_++)n=d[_],n&&(a=".__ue"+n,u.off("mousedown"+a),u.off("touchstart"+a),u.off("mousewheel"+a));e.removeData(r,w),t.remove_val(this),0===t.length&&(e(document).off("mousemove.__ue"),e(document).off("touchmove.__ue"),e(document).off("mouseup.__ue"),e(document).off("touchend.__ue"),e(document).off("touchcancel.__ue"),b=!1)}}},s=function(t){var o,_=+new Date,a=t.motion_id,d=t.motion_map,r=t.bound_ns_map;delete d.tapheld_toid,d.do_allow_held&&(d.px_end_x=d.px_start_x,d.px_end_y=d.px_start_y,d.ms_timestop=_,d.ms_elapsed=_-d.ms_timestart,r.uheld&&(o=e.Event("uheld"),e.extend(o,d),e(d.elem_bound).trigger(o)),r.uheldstart?(o=e.Event("uheldstart"),e.extend(o,d),e(d.elem_bound).trigger(o),n=a):delete g[a])},p=function(t){var o,_,n,u=t.motion_id,i=t.event_src,l=t.request_dzoom,m=e.data(t.elem,w),p=m.bound_ns_map,c=e(i.target),h=!1;if(!(g[u]||l&&!p.uzoomstart||c.is(m.ignore_select))){for(i.preventDefault(),_=E.pop();_;)c.is(_.selector_str)||e(t.elem).is(_.selector_str)?_.callback_match&&_.callback_match(t):_.callback_nomatch&&_.callback_nomatch(t),_=E.pop();return o={do_allow_tap:p.utap?!0:!1,do_allow_held:p.uheld||p.uheldstart?!0:!1,elem_bound:t.elem,elem_target:i.target,ms_elapsed:0,ms_timestart:i.timeStamp,ms_timestop:void 0,option_map:m,orig_target:i.target,px_current_x:i.clientX,px_current_y:i.clientY,px_end_x:void 0,px_end_y:void 0,px_start_x:i.clientX,px_start_y:i.clientY,timeStamp:i.timeStamp},g[u]=o,p.uzoomstart&&(l?a=u:d?r||(r=u,n=e.Event("uzoomstart"),h=!0):d=u,h)?(n=e.Event("uzoomstart"),o.px_delta_zoom=0,e.extend(n,o),void e(o.elem_bound).trigger(n)):void((p.uheld||p.uheldstart)&&(o.tapheld_toid=setTimeout(function(){s({motion_id:u,motion_map:o,bound_ns_map:p})},m.min_held_ms)))}},c=function(t){var o,u,i,l,m,s,p,c,h,x=t.motion_id,v=t.event_src,f=!1;if(g[x])return v.preventDefault(),o=g[x],u=o.option_map,i=u.bound_ns_map,o.timeStamp=v.timeStamp,o.elem_target=v.target,o.ms_elapsed=v.timeStamp-o.ms_timestart,o.px_delta_x=v.clientX-o.px_current_x,o.px_delta_y=v.clientY-o.px_current_y,o.px_current_x=v.clientX,o.px_current_y=v.clientY,o.px_tdelta_x=o.px_start_x-v.clientX,o.px_tdelta_y=o.px_start_y-v.clientY,l=Math.abs(o.px_tdelta_x)>u.px_radius||Math.abs(o.px_tdelta_y)>u.px_radius,o.timeStamp=v.timeStamp,l&&(o.do_allow_tap=!1,o.do_allow_held=!1),o.ms_elapsed>u.max_tap_ms&&(o.do_allow_tap=!1),d&&r&&(x===d||x===r)?(g[x]=o,c=g[d],h=g[r],s=Math.floor(Math.sqrt(Math.pow(c.px_current_x-h.px_current_x,2)+Math.pow(c.px_current_y-h.px_current_y,2))+.5),p=-1===y?0:(s-y)*X,y=s,f=!0):a===x&&i.uzoommove&&(p=o.px_delta_y*k,f=!0),f?(m=e.Event("uzoommove"),o.px_delta_zoom=p,e.extend(m,o),void e(o.elem_bound).trigger(m)):n===x?void(i.uheldmove&&(m=e.Event("uheldmove"),e.extend(m,o),e(o.elem_bound).trigger(m))):_===x?void(i.udragmove&&(m=e.Event("udragmove"),e.extend(m,o),e(o.elem_bound).trigger(m))):void(!i.udragstart||o.do_allow_tap!==!1||o.do_allow_held!==!1||_&&n||(_=x,m=e.Event("udragstart"),e.extend(m,o),e(o.elem_bound).trigger(m),o.tapheld_toid&&(clearTimeout(o.tapheld_toid),delete o.tapheld_toid)))},h=function(t){var o,u,i,l,m=t.motion_id,s=t.event_src,p=!1;z=!1,g[m]&&(o=g[m],u=o.option_map,i=u.bound_ns_map,o.elem_target=s.target,o.ms_elapsed=s.timeStamp-o.ms_timestart,o.ms_timestop=s.timeStamp,o.px_current_x&&(o.px_delta_x=s.clientX-o.px_current_x,o.px_delta_y=s.clientY-o.px_current_y),o.px_current_x=s.clientX,o.px_current_y=s.clientY,o.px_end_x=s.clientX,o.px_end_y=s.clientY,o.px_tdelta_x=o.px_start_x-o.px_end_x,o.px_tdelta_y=o.px_start_y-o.px_end_y,o.timeStamp=s.timeStamp,o.tapheld_toid&&(clearTimeout(o.tapheld_toid),delete o.tapheld_toid),i.utap&&o.ms_elapsed<=u.max_tap_ms&&o.do_allow_tap&&(l=e.Event("utap"),e.extend(l,o),e(o.elem_bound).trigger(l)),m===_&&(i.udragend&&(l=e.Event("udragend"),e.extend(l,o),e(o.elem_bound).trigger(l)),_=void 0),m===n&&(i.uheldend&&(l=e.Event("uheldend"),e.extend(l,o),e(o.elem_bound).trigger(l)),n=void 0),m===a?(p=!0,a=void 0):m===d&&(r?(d=r,r=void 0,p=!0):d=void 0,y=-1),m===r&&(r=void 0,y=-1,p=!0),p&&i.uzoomend&&(l=e.Event("uzoomend"),o.px_delta_zoom=0,e.extend(l,o),e(o.elem_bound).trigger(l)),delete g[m])},v=function(e){var t,o,_,n,a=this,d=+new Date,r=e.originalEvent,u=r?r.changedTouches||[]:[],i=u.length;switch(z=!0,e.timeStamp=d,e.type){case"touchstart":n=p;break;case"touchmove":n=c;break;case"touchend":case"touchcancel":n=h;break;default:n=null}if(n)for(t=0;i>t;t++)o=u[t],_="touch"+String(o.identifier),e.clientX=o.clientX,e.clientY=o.clientY,n({elem:a,motion_id:_,event_src:e})},x=function(e){var t,o=this,_="mouse"+String(e.button),n=!1;if(z)return void e.stopImmediatePropagation();if(e.shiftKey&&(n=!0),"mousemove"!==e.type&&0!==e.button)return!0;switch(e.type){case"mousedown":t=p;break;case"mouseup":t=h;break;case"mousemove":t=c;break;default:t=null}t&&t({elem:o,event_src:e,request_dzoom:n,motion_id:_})},f.ue=f.utap=f.uheld=f.uzoomstart=f.uzoommove=f.uzoomend=f.udragstart=f.udragmove=f.udragend=f.uheldstart=f.uheldmove=f.uheldend=o,e.ueSetGlobalCb=function(e,t,o){E.push({selector_str:e||"",callback_match:t||null,callback_nomatch:o||null})}}(jQuery);